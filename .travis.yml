# R for travis: see documentation at https://docs.travis-ci.com/user/languages/r

language: R
cache: packages
warnings_are_errors: true

# using matrix argument for multiple os CI https://github.com/zappingseb/RTest/blob/master/.travis.yml
matrix:
  include:
  - r: release
    script:
      - R CMD build . --compact-vignettes=gs+qpdf
      - xvfb-run R CMD check *tar.gz --as-cran
    after_success:
      - tar -C .. -xf $PKG_TARBALL
      - xvfb-run Rscript -e 'covr::coveralls(type = "all")'
  - r: release
    os: osx
    osx_image: xcode12
    before_install:
      - brew update
      - brew cask reinstall xquartz
      - brew install tcl-tk
      - brew link --overwrite --force tcl-tk; brew unlink tcl-tk
      - sudo tlmgr update --self
      - sudo tlmgr install framed titling
    # FROM https://github.com/travis-ci/travis-ci/issues/7313
    script:
      - R CMD build . --compact-vignettes=gs+qpdf
      - R CMD check *tar.gz --as-cran

environment:
  global:
    WARNINGS_ARE_ERRORS: 1
